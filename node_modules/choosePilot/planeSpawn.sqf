private ["_planeTyp", "_initialPos", "_pilot", "_initX", "_initY", "_spawnOpforPosX", "_spawnOpforPosY", "_dX", "_dY", "_ang", "_newX", "_newY"];

_this params ["_planeTyp", "_initialPos"];

//calculate th 
_initX = _initialPos select 0;
_initY = _initialPos select 1;

_spawnOpforPosX = OPFORSPAWN select 0;
_spawnOpforPosY = OPFORSPAWN select 1;

_dX = _spawnOpforPosX - _initX;
_dY = _spawnOpforPosY - _initY;

//get angle between markers
_ang = _dX atan2 _dY;

_ang = _ang + 180;

//fix angle if <0 or >360
_ang = _ang mod 360;

//find new coords
_newX = _initX + sin(_ang)*1000;
_newY = _initY + cos(_ang)*1000;

if (_newX < _newY) then {
	_newX = 0;
}else{
	_newY = 0;
};

_newcoords = [ _newX, _newY, 500];

createVehicle [_planeTyp, [0, 0, 1000], [], 0, "FLY"];
_plane setPos _newcoords;
_plane setDir _ang;
_plane engineOn true;
_plane setVelocity 200;
PILOT moveInDriver _plane;

switch _planeTyp do 
{
	case "LIB_FW190F8" : {}; 
	case "LIB_Ju87" : {}; 
	case "LIB_P39" : {}; 
	case "LIB_Pe2" : {}; 
	case "LIB_Li2" : {}; 
	case "LIB_P47" : {}; 
};

_planeString = "Spawned " + _planeTyp + "!";
[
    WEST,
    _planeString,
    true,
    _newcoords,
   "hd_dot",
    "COLOREAST",
    "CAPTURE ZONE",
    "ICON",
    1,
    1
] call uo_fnc_createSideMarker;

_waitingTime = random [30,150,300];
sleep _waitingTime;

[[true,"An Enemy " + _planeTyp + " has entered the Airspace!","All hands on Action Station"], "uo_ui_fnc_twoLineHint", "EAST"] call BIS_fnc_MP;